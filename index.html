<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×”×©×£ ×”×§×•×œ×™ - ×¡×¤×¨ ×”××ª×›×•× ×™× ×©×œ×™</title>
    <style>
        :root { 
            --primary: #f39c12; 
            --bg: #fdfdfd; 
            --text: #000; 
            --card-bg: #fff; 
            --accent-bg: #fff9f0; 
            --input-border: #ddd;
        }
        
        body.dark-mode { 
            --bg: #1e1e1e; 
            --text: #ffffff; 
            --card-bg: #2d2d2d; 
            --accent-bg: #3d3d3d;
            --input-border: #444;
        }

        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background-color: var(--bg); 
            color: var(--text); 
            margin: 0; 
            padding: 10px; 
            direction: rtl; 
            transition: all 0.3s ease;
        }
        
        .screen { display: none; max-width: 500px; margin: 20px auto; background: var(--card-bg); padding: 25px; border-radius: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); border: 1px solid rgba(0,0,0,0.05); }
        .active { display: block; animation: slideIn 0.5s ease; }
        
        @keyframes slideIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        input, textarea { width: 100%; padding: 14px; margin: 10px 0; border-radius: 12px; border: 2px solid var(--input-border); box-sizing: border-box; font-size: 16px; background: var(--card-bg); color: var(--text); }
        
        .search-container { position: relative; margin-bottom: 15px; }
        .search-container input { padding-right: 40px; border-color: var(--primary); }
        .search-icon { position: absolute; right: 12px; top: 50%; transform: translateY(-50%); font-size: 18px; }

        button { width: 100%; padding: 15px; margin: 10px 0; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; font-size: 16px; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .main-btn { background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(243, 156, 18, 0.3); }
        .secondary-btn { background: #ecf0f1; color: #34495e; }
        body.dark-mode .secondary-btn { background: #3d3d3d; color: #fff; }
        .danger-btn { background: #e74c3c; color: white; }

        .recipe-grid { display: grid; gap: 15px; margin-top: 10px; }
        .recipe-card { display: flex; align-items: center; background: var(--card-bg); border-radius: 18px; overflow: hidden; cursor: pointer; transition: 0.3s; border: 1px solid rgba(0,0,0,0.05); height: 110px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .recipe-card img { width: 110px; height: 110px; object-fit: cover; }
        .recipe-card-info { padding: 15px; flex-grow: 1; font-weight: bold; font-size: 19px; }

        .ingredients-box { background: var(--accent-bg); padding: 20px; border-radius: 15px; margin-bottom: 20px; border-right: 8px solid var(--primary); color: #000; font-weight: 600; font-size: 19px; line-height: 1.7; }
        
        #viewInstructions p { padding: 18px; border-radius: 12px; background: rgba(0,0,0,0.03); margin-bottom: 12px; border-right: 5px solid transparent; color: var(--text); font-size: 18px; line-height: 1.5; }
        .active-step { background: #fff3e0 !important; border-right-color: var(--primary) !important; color: #d35400 !important; font-weight: bold; transform: scale(1.03); }
        
        .nav-flex { display: flex; gap: 12px; }
        .settings-footer { margin-top: 20px; border-top: 1px solid #eee; padding-top: 10px; }
    </style>
</head>
<body>

<div id="loginScreen" class="screen active">
    <div style="text-align: center;">
        <h1 style="color: var(--primary); margin-bottom: 5px;">ğŸ³ ×”×©×£ ×”×§×•×œ×™</h1>
        <p style="margin-top: 0; opacity: 0.8;">×¡×¤×¨ ×”××ª×›×•× ×™× ×”××™×©×™ ×©×œ×š</p>
    </div>
    <input type="text" id="username" placeholder="×©× ××©×ª××©">
    <input type="password" id="password" placeholder="×¡×™×¡××”">
    <button onclick="login()" class="main-btn">×›× ×™×¡×” ×œ××˜×‘×— âœ¨</button>
    <button onclick="register()" class="secondary-btn">×”×¨×©××” (××©×ª××© ×—×“×©)</button>
</div>

<div id="listScreen" class="screen">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 15px;">
        <h2 id="welcomeMsg" style="margin:0;">×”××ª×›×•× ×™× ×©×œ×™</h2>
        <button onclick="logout()" style="width:auto; padding:8px 15px; margin:0;" class="danger-btn">×™×¦×™××”</button>
    </div>
    <div class="search-container">
        <span class="search-icon">ğŸ”</span>
        <input type="text" id="searchInput" placeholder="×—×¤×©×™ ××ª×›×•×Ÿ..." oninput="renderRecipes()">
    </div>
    <button onclick="openAddRecipe()" class="main-btn">â• ×”×•×¡×¤×ª ××ª×›×•×Ÿ ×—×“×©</button>
    <div id="recipeList" class="recipe-grid"></div>
    <div class="settings-footer"><button onclick="showScreen('settingsScreen')" class="secondary-btn">âš™ï¸ ×”×’×“×¨×•×ª</button></div>
</div>

<div id="addRecipeScreen" class="screen">
    <h2 id="addRecipeTitle">ğŸ“ ×™×¦×™×¨×ª ××ª×›×•×Ÿ ×—×“×©</h2>
    <input type="hidden" id="editIndex">
    <input type="text" id="newTitle" placeholder="×©× ×”×× ×”">
    <input type="text" id="newImg" placeholder="×§×™×©×•×¨ ×œ×ª××•× ×”">
    <textarea id="newIngredients" rows="3" placeholder="××¦×¨×›×™×"></textarea>
    <textarea id="newSteps" rows="5" placeholder="×©×œ×‘×™ ×”×›× ×” (×›×œ ×©×œ×‘ ×‘×©×•×¨×”)"></textarea>
    <div class="nav-flex">
        <button onclick="saveRecipe()" class="main-btn">×©××•×¨ ××ª×›×•×Ÿ</button>
        <button onclick="showScreen('listScreen')" class="secondary-btn">×‘×™×˜×•×œ</button>
    </div>
</div>

<div id="recipeViewScreen" class="screen">
    <img id="viewImg" style="width:100%; height:250px; object-fit:cover; border-radius:20px; margin-bottom:15px;">
    <h2 id="viewTitle" style="font-size: 28px; margin:0;"></h2>
    <button onclick="editCurrentRecipe()" class="secondary-btn" style="width:auto; padding:5px 15px; font-size:14px; margin-bottom:15px;">âœï¸ ×¢×¨×•×š ××ª×›×•×Ÿ</button>
    
    <div class="ingredients-box">
        <strong style="color:var(--primary);">ğŸ›’ ××” ×¦×¨×™×š?</strong><br>
        <span id="viewIngredients"></span>
    </div>
    <div id="viewInstructions"></div>
    <div class="nav-flex">
        <button onclick="startReading()" class="main-btn">â–¶ï¸ ×”×§×¨××”</button>
        <button onclick="stopReading()" class="danger-btn">ğŸ›‘ ×¢×¦×•×¨</button>
    </div>
    <button onclick="showScreen('listScreen')" class="secondary-btn">×—×–×•×¨</button>
</div>

<div id="settingsScreen" class="screen">
    <h2>âš™ï¸ ×”×’×“×¨×•×ª</h2>
    <button onclick="toggleDarkMode()" class="secondary-btn">ğŸŒ“ ××¦×‘ ×™×•×/×œ×™×œ×”</button>
    <input type="number" id="delayInput" placeholder="×–××Ÿ ×”××ª× ×” ×‘×©× ×™×•×ª">
    <button onclick="showScreen('listScreen')" class="main-btn">×©××•×¨ ×•×¡×’×•×¨</button>
</div>

<script>
    let currentUser = null;
    let isDarkMode = false;
    let currentRecipeObj = null; 
    const synth = window.speechSynthesis;

    const masterRecipes = [
        { title: "×—×œ×•×ª ×©×‘×ª ××•×•×¨×™×¨×™×•×ª", img: "https://images.unsplash.com/photo-1620921515233-066989447cc0?w=400", ing: "1 ×§×™×œ×• ×§××—, 2 ×›×¤×•×ª ×©××¨×™×, ×—×¦×™ ×›×•×¡ ×¡×•×›×¨, ×›×£ ××œ×—, ×—×¦×™ ×›×•×¡ ×©××Ÿ, 2.5 ×›×•×¡×•×ª ××™×", steps: ["××¢×¨×‘×‘×™× ××ª ×›×œ ×”×—×•××¨×™× ×”×™×‘×©×™× ×‘×§×¢×¨×”", "××•×¡×™×¤×™× ××™× ×•×©××Ÿ ×•×œ×©×™× ×”×™×˜×‘ 10 ×“×§×•×ª", "××ª×¤×™×—×™× ××ª ×”×‘×¦×§ ×‘××§×•× ×—× ×œ××©×š ×©×¢×”", "×™×•×¦×¨×™× ×¦×•×¨×•×ª ×©×œ ×—×œ×”, ××ª×¤×™×—×™× ×©×•×‘ ×•××•×¤×™×"] },
        { title: "×©× ×™×¦×œ ×¤×¨×™×š", img: "https://images.unsplash.com/photo-1594834712647-3c933b9c4746?w=400", ing: "×—×–×” ×¢×•×£ ×¤×¨×•×¡, ×‘×™×¦×™×, ×¤×™×¨×•×¨×™ ×œ×—×, ××œ×— ×•×¤×œ×¤×œ", steps: ["××›×™× ×™× ×¦×œ×—×ª ×¢× ×‘×™×¦×” ×˜×¨×•×¤×” ×•×¦×œ×—×ª ×¢× ×¤×™×¨×•×¨×™ ×œ×—×", "×˜×•×‘×œ×™× ×›×œ × ×ª×— ×¢×•×£ ×‘×‘×™×¦×” ×•××– ×‘×¤×™×¨×•×¨×™ ×”×œ×—×", "××˜×’× ×™× ×‘×©××Ÿ ×—× ×¢×“ ×©×”×©× ×™×¦×œ ×”×•×¤×š ×œ×–×”×‘"] },
        { title: "×¤×¡×˜×” ×¢×’×‘× ×™×•×ª", img: "https://images.unsplash.com/photo-1546548970-71785318a17b?w=400", ing: "×—×‘×™×œ×ª ×¤×¡×˜×”, ×¨×¡×§ ×¢×’×‘× ×™×•×ª, ×©×•×, ×‘×¦×œ, ×ª×‘×œ×™× ×™×", steps: ["××‘×©×œ×™× ××ª ×”×¤×¡×˜×” ×œ×¤×™ ×”×•×¨××•×ª ×”×™×¦×¨×Ÿ", "××˜×’× ×™× ×‘×¦×œ ×•×©×•× ×•××•×¡×™×¤×™× ×¨×¡×§ ×•×ª×‘×œ×™× ×™×", "××¢×¨×‘×‘×™× ××ª ×”×¤×¡×˜×” ×”××•×›× ×” ×¢× ×”×¨×•×˜×‘"] },
        { title: "××¨×§ ×¢×•×£ ×¢×©×™×¨", img: "https://images.unsplash.com/photo-1547592166-23ac45744acd?w=400", ing: "×—×œ×§×™ ×¢×•×£, ×’×–×¨, ×§×™×©×•×, ×‘×¦×œ, ×¡×œ×¨×™, ××œ×—", steps: ["××›× ×™×¡×™× ××ª ×”×¢×•×£ ×•×”×™×¨×§×•×ª ×œ×¡×™×¨ ×’×“×•×œ", "×××œ××™× ×‘××™× ×•××‘×™××™× ×œ×¨×ª×™×—×”", "××‘×©×œ×™× ×¢×œ ××© ×§×˜× ×” ×›×©×¢×” ×•×—×¦×™"] },
        { title: "×¡×œ×˜ ×™×•×•× ×™", img: "https://images.unsplash.com/photo-1540189549336-e6e99c3679fe?w=400", ing: "×™×¨×§×•×ª ×—×ª×•×›×™×, ×’×‘×™× ×” ×‘×•×œ×’×¨×™×ª, ×–×™×ª×™×, ×©××Ÿ ×–×™×ª", steps: ["×—×•×ª×›×™× ××ª ×›×œ ×”×™×¨×§×•×ª ×œ×§×•×‘×™×•×ª", "××¤×–×¨×™× ××¢×œ ×’×‘×™× ×” ×‘×•×œ×’×¨×™×ª ×•×–×™×ª×™×", "××ª×‘×œ×™× ×‘×©××Ÿ ×–×™×ª ×•×œ×™××•×Ÿ"] },
        { title: "×¢×•×’×ª ×©×•×§×•×œ×“", img: "https://images.unsplash.com/photo-1564031350635-27c6a2127347?w=400", ing: "×©×•×§×•×œ×“ ××¨×™×¨, ×‘×™×¦×™×, ×¡×•×›×¨, ×§××—", steps: ["×××™×¡×™× ×©×•×§×•×œ×“ ×¢× ×—×××”", "××•×¡×™×¤×™× ×¡×•×›×¨, ×‘×™×¦×™× ×•×§××— ×•××¢×¨×‘×‘×™×", "××•×¤×™× ×‘-180 ××¢×œ×•×ª ×›-25 ×“×§×•×ª"] },
        { title: "××•×¨×– ×œ×‘×Ÿ ××•×©×œ×", img: "https://images.unsplash.com/photo-1516684732162-798a0062be99?w=400", ing: "×›×•×¡ ××•×¨×–, 2 ×›×•×¡×•×ª ××™×, ××œ×—, ×©××Ÿ", steps: ["××˜×’× ×™× ××ª ×”××•×¨×– ×¢× ××¢×˜ ×©××Ÿ ×›×©×ª×™ ×“×§×•×ª", "××•×¡×™×¤×™× ××™× ×¨×•×ª×—×™× ×•××œ×—", "×¡×•×’×¨×™× ××ª ×”×¡×™×¨ ×•××‘×©×œ×™× ×¢×œ ××© ×§×˜× ×” 20 ×“×§×•×ª"] },
        { title: "×§×¦×™×¦×•×ª ×‘×¨×•×˜×‘", img: "https://images.unsplash.com/photo-1529006557810-274b9b2fc783?w=400", ing: "×‘×©×¨ ×˜×—×•×Ÿ, ×‘×¦×œ, ×œ×—× ×¡×—×•×˜, ×ª×‘×œ×™× ×™×, ×¨×¡×§", steps: ["××¢×¨×‘×‘×™× ××ª ×”×‘×©×¨ ×¢× ×‘×¦×œ ×•×ª×‘×œ×™× ×™× ×•×™×•×¦×¨×™× ×›×“×•×¨×™×", "××›×™× ×™× ×¨×•×˜×‘ ×¢×’×‘× ×™×•×ª ×‘×¡×™×¨ ×¨×—×‘", "××‘×©×œ×™× ××ª ×”×§×¦×™×¦×•×ª ×‘×ª×•×š ×”×¨×•×˜×‘ ×›×—×¦×™ ×©×¢×”"] },
        { title: "×¤×™×¦×” ×‘×™×ª×™×ª", img: "https://images.unsplash.com/photo-1513104890138-7c749659a591?w=400", ing: "×‘×¦×§ ×¤×™×¦×”, ×¨×•×˜×‘ ×¢×’×‘× ×™×•×ª, ×’×‘×™× ×” ×¦×”×•×‘×”", steps: ["××¨×“×“×™× ××ª ×”×‘×¦×§ ×¢×œ ×ª×‘× ×™×ª ××¤×™×™×”", "××•×¨×—×™× ×¨×•×˜×‘ ×•××¤×–×¨×™× ×”××•×Ÿ ×’×‘×™× ×” ×•×ª×•×¡×¤×•×ª", "××•×¤×™× ×‘×—×•× ×’×‘×•×” ×¢×“ ×©×”×’×‘×™× ×” ××‘×¢×‘×¢×ª"] },
        { title: "×¤× ×§×™×™×§", img: "https://images.unsplash.com/photo-1528207776546-365bb710ee93?w=400", ing: "×›×•×¡ ×—×œ×‘, ×›×•×¡ ×§××—, ×‘×™×¦×”, ×›×£ ×¡×•×›×¨", steps: ["××¢×¨×‘×‘×™× ××ª ×›×œ ×”××¨×›×™×‘×™× ×œ×‘×œ×™×œ×” ×—×œ×§×”", "××©×× ×™× ××—×‘×ª ×•××˜×’× ×™× ×¢×™×’×•×œ×™× ×§×˜× ×™×", "×”×•×¤×›×™× ×›×©××•×¤×™×¢×•×ª ×‘×•×¢×•×ª ×¢×œ ×”×¦×“ ×”×¢×œ×™×•×Ÿ"] }
    ];

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function toggleDarkMode() {
        isDarkMode = !isDarkMode;
        document.body.classList.toggle('dark-mode', isDarkMode);
    }

    function register() {
        const u = document.getElementById('username').value.trim();
        const p = document.getElementById('password').value;
        if (!u || !p) return alert("× × ×œ×”×–×™×Ÿ ×©× ×•×¡×™×¡××”");
        
        let users = JSON.parse(localStorage.getItem('users')) || [];
        if (users.find(x => x.user === u)) return alert("×©× ××©×ª××© ×–×” ×›×‘×¨ ×§×™×™×");
        
        users.push({ user: u, pass: p, delay: 3 });
        localStorage.setItem('users', JSON.stringify(users));
        alert("× ×¨×©××ª ×‘×”×¦×œ×—×”! ×¢×›×©×™×• ×ª×•×›×œ×™ ×œ×”×™×›× ×¡.");
    }

    function login() {
        const u = document.getElementById('username').value.trim();
        const p = document.getElementById('password').value;
        if (!u || !p) return alert("× × ×œ×”×–×™×Ÿ ×©× ×•×¡×™×¡××”");

        let users = JSON.parse(localStorage.getItem('users')) || [];
        let user = users.find(x => x.user === u && x.pass === p);
        
        if (!user) return alert("×©× ××©×ª××© ××• ×¡×™×¡××” ×©×’×•×™×™×");

        currentUser = user;
        document.getElementById('delayInput').value = currentUser.delay;
        document.getElementById('welcomeMsg').innerText = `×”××ª×›×•× ×™× ×©×œ ${u}`;
        
        // ×˜×¢×™× ×ª ××ª×›×•× ×™× ×¨××©×•× ×™×ª ×× ××™×Ÿ ×œ××©×ª××©
        if (!localStorage.getItem('recipes_' + u)) {
            localStorage.setItem('recipes_' + u, JSON.stringify(masterRecipes));
        }
        
        renderRecipes();
        showScreen('listScreen');
    }

    function renderRecipes() {
        const list = document.getElementById('recipeList');
        const query = document.getElementById('searchInput').value.toLowerCase();
        const recipes = JSON.parse(localStorage.getItem('recipes_' + currentUser.user)) || [];
        
        list.innerHTML = '';
        const filtered = recipes.filter(r => r.title.toLowerCase().includes(query));
        
        if (filtered.length === 0) {
            list.innerHTML = `<p style="text-align:center; opacity:0.6; padding:20px;">×œ× ××¦××ª×™ ××ª×›×•×Ÿ ×›×–×”... ğŸ³</p>`;
            return;
        }

        filtered.forEach((r, index) => {
            const card = document.createElement('div');
            card.className = 'recipe-card';
            card.innerHTML = `<img src="${r.img}"><div class="recipe-card-info">${r.title}</div>`;
            card.onclick = () => openRecipe(r, index);
            list.appendChild(card);
        });
    }

    function openRecipe(r, index) {
        currentRecipeObj = {...r, index: index};
        document.getElementById('viewTitle').innerText = r.title;
        document.getElementById('viewImg').src = r.img;
        document.getElementById('viewIngredients').innerText = r.ingredients;
        document.getElementById('viewInstructions').innerHTML = r.steps.map((s, i) => `<p id="step-${i}">${s}</p>`).join('');
        document.getElementById('viewInstructions').dataset.steps = JSON.stringify(r.steps);
        showScreen('recipeViewScreen');
    }

    function openAddRecipe() {
        document.getElementById('addRecipeTitle').innerText = "ğŸ“ ×™×¦×™×¨×ª ××ª×›×•×Ÿ ×—×“×©";
        document.getElementById('editIndex').value = "";
        document.getElementById('newTitle').value = "";
        document.getElementById('newImg').value = "";
        document.getElementById('newIngredients').value = "";
        document.getElementById('newSteps').value = "";
        showScreen('addRecipeScreen');
    }

    function editCurrentRecipe() {
        document.getElementById('addRecipeTitle').innerText = "âœï¸ ×¢×¨×™×›×ª ××ª×›×•×Ÿ";
        document.getElementById('editIndex').value = currentRecipeObj.index;
        document.getElementById('newTitle').value = currentRecipeObj.title;
        document.getElementById('newImg').value = currentRecipeObj.img;
        document.getElementById('newIngredients').value = currentRecipeObj.ingredients;
        document.getElementById('newSteps').value = currentRecipeObj.steps.join('\n');
        showScreen('addRecipeScreen');
    }

    function saveRecipe() {
        const title = document.getElementById('newTitle').value;
        const img = document.getElementById('newImg').value || "https://via.placeholder.com/400?text=Food";
        const ingredients = document.getElementById('newIngredients').value;
        const steps = document.getElementById('newSteps').value.split('\n').filter(s => s.trim() !== '');
        const editIndex = document.getElementById('editIndex').value;

        if (!title || !ingredients) return alert("××œ××™ ××ª ×›×œ ×”×©×“×•×ª");

        let recipes = JSON.parse(localStorage.getItem('recipes_' + currentUser.user));
        
        if (editIndex !== "") {
            recipes[editIndex] = { title, img, ingredients, steps };
        } else {
            recipes.push({ title, img, ingredients, steps });
        }

        localStorage.setItem('recipes_' + currentUser.user, JSON.stringify(recipes));
        renderRecipes();
        showScreen('listScreen');
    }

    function startReading() {
        const steps = JSON.parse(document.getElementById('viewInstructions').dataset.steps);
        const delay = (document.getElementById('delayInput').value || 3) * 1000;
        synth.cancel();
        let i = 0;
        function speak() {
            if (i < steps.length) {
                document.querySelectorAll('#viewInstructions p').forEach(p => p.className = '');
                const currentEl = document.getElementById(`step-${i}`);
                if (currentEl) currentEl.className = 'active-step';
                
                const u = new SpeechSynthesisUtterance(steps[i]);
                u.lang = 'he-IL';
                u.onend = () => { i++; if (i < steps.length) setTimeout(speak, delay); };
                synth.speak(u);
            }
        }
        speak();
    }

    function stopReading() { synth.cancel(); }
    function logout() { location.reload(); }
</script>
</body>
</html>
